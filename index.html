<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ•ã‚©ãƒ³ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ„ãƒ¼ãƒ«</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .controls {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-button {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-button:hover:not(.active) {
            background: #f0f0f0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-button {
            display: block;
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s;
        }

        .file-input-button:hover {
            transform: translateY(-2px);
        }

        .file-name {
            margin-top: 8px;
            font-size: 13px;
            color: #666;
            font-style: italic;
        }

        select,
        input[type="text"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        select:focus,
        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .slider-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .slider-container {
            background: white;
            padding: 15px;
            border-radius: 8px;
        }

        input[type="range"] {
            width: 100%;
            margin-top: 8px;
        }

        .slider-value {
            display: inline-block;
            margin-left: 10px;
            font-weight: 600;
            color: #667eea;
        }

        .font-list {
            padding: 20px;
            max-height: 600px;
            overflow-y: auto;
        }

        .font-item {
            padding: 20px;
            margin-bottom: 15px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            transition: all 0.3s;
        }

        .font-item:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
        }

        .font-name {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .font-preview {
            word-wrap: break-word;
            line-height: 1.5;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .search-box {
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
        }

        @media (max-width: 768px) {
            .slider-group {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 24px;
            }

            .controls {
                padding: 20px;
            }

            .tab-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”¤ ãƒ•ã‚©ãƒ³ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ„ãƒ¼ãƒ«</h1>
            <p>ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚©ãƒ³ãƒˆã‚’è‡ªå‹•æ¤œå‡º / ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</p>
        </div>

        <div class="controls">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="switchTab('installed')">
                    ğŸ’» ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒ•ã‚©ãƒ³ãƒˆ
                </button>
                <button class="tab-button" onclick="switchTab('upload')">
                    ğŸ“ ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
                </button>
            </div>

            <div id="installedTab" class="tab-content active">
                <div class="control-group">
                    <label>è¡¨ç¤ºã™ã‚‹æ–‡å­—åˆ—</label>
                    <textarea 
                        id="textInput1" 
                        placeholder="ã“ã“ã«è¡¨ç¤ºã—ãŸã„æ–‡å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."
                        oninput="updateInstalledFonts()"
                    >The quick brown fox jumps over the lazy dog
ã‚ã®ã‚¤ãƒ¼ãƒãƒˆãƒ¼ãƒ´ã‚©ã®ã™ãã¨ãŠã£ãŸé¢¨</textarea>
                </div>

                <div class="slider-group">
                    <div class="slider-container">
                        <label>
                            ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º
                            <span class="slider-value" id="fontSizeValue1">32px</span>
                        </label>
                        <input type="range" id="fontSize1" min="12" max="72" value="32" oninput="updateInstalledFonts()">
                    </div>

                    <div class="slider-container">
                        <label>
                            è¡Œé–“
                            <span class="slider-value" id="lineHeightValue1">1.5</span>
                        </label>
                        <input type="range" id="lineHeight1" min="0.8" max="3" step="0.1" value="1.5" oninput="updateInstalledFonts()">
                    </div>
                </div>

                <div class="search-box">
                    <input type="text" id="fontSearch" placeholder="ğŸ” ãƒ•ã‚©ãƒ³ãƒˆåã§æ¤œç´¢..." oninput="filterFonts()">
                </div>
            </div>

            <div id="uploadTab" class="tab-content">
                <div class="control-group">
                    <label>ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ« (.ttf, .otf, .woff, .woff2)</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="fontFile" accept=".ttf,.otf,.woff,.woff2">
                        <div class="file-input-button">
                            ğŸ“ ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
                        </div>
                    </div>
                    <div class="file-name" id="fileName">ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“</div>
                </div>

                <div class="control-group">
                    <label>è¡¨ç¤ºã™ã‚‹æ–‡å­—åˆ—</label>
                    <textarea 
                        id="textInput2" 
                        placeholder="ã“ã“ã«è¡¨ç¤ºã—ãŸã„æ–‡å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."
                    >The quick brown fox jumps over the lazy dog
ã‚ã®ã‚¤ãƒ¼ãƒãƒˆãƒ¼ãƒ´ã‚©ã®ã™ãã¨ãŠã£ãŸé¢¨</textarea>
                </div>

                <div class="slider-group">
                    <div class="slider-container">
                        <label>
                            ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º
                            <span class="slider-value" id="fontSizeValue2">48px</span>
                        </label>
                        <input type="range" id="fontSize2" min="12" max="120" value="48">
                    </div>

                    <div class="slider-container">
                        <label>
                            è¡Œé–“
                            <span class="slider-value" id="lineHeightValue2">1.5</span>
                        </label>
                        <input type="range" id="lineHeight2" min="0.8" max="3" step="0.1" value="1.5">
                    </div>
                </div>
            </div>
        </div>

        <div class="font-list" id="fontList">
            <div class="loading">ãƒ•ã‚©ãƒ³ãƒˆä¸€è¦§ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...</div>
        </div>

        <div class="font-list" id="uploadPreview" style="display: none;">
            <div class="font-item">
                <div class="font-name" id="uploadFontName">ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ³ãƒˆ</div>
                <div class="font-preview" id="previewText"></div>
            </div>
        </div>
    </div>

    <script>
        let allFonts = [];
        let currentFont = null;

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        function switchTab(tab) {
            const buttons = document.querySelectorAll('.tab-button');
            const contents = document.querySelectorAll('.tab-content');
            
            buttons.forEach(btn => btn.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            if (tab === 'installed') {
                buttons[0].classList.add('active');
                document.getElementById('installedTab').classList.add('active');
                document.getElementById('fontList').style.display = 'block';
                document.getElementById('uploadPreview').style.display = 'none';
                loadInstalledFonts();
            } else {
                buttons[1].classList.add('active');
                document.getElementById('uploadTab').classList.add('active');
                document.getElementById('fontList').style.display = 'none';
                document.getElementById('uploadPreview').style.display = 'block';
            }
        }

        // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒ•ã‚©ãƒ³ãƒˆã®èª­ã¿è¾¼ã¿
        async function loadInstalledFonts() {
            const fontList = document.getElementById('fontList');
            
            // Local Font Access APIãŒä½¿ç”¨å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
            if ('queryLocalFonts' in window) {
                try {
                    fontList.innerHTML = '<div class="loading">ãƒ•ã‚©ãƒ³ãƒˆä¸€è¦§ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...<br>åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã¯è¨±å¯ãŒå¿…è¦ã§ã™</div>';
                    
                    // ãƒ•ã‚©ãƒ³ãƒˆã‚¢ã‚¯ã‚»ã‚¹ã®è¨±å¯ã‚’è¦æ±‚
                    const availableFonts = await window.queryLocalFonts();
                    
                    // ãƒ•ã‚©ãƒ³ãƒˆåã‚’å–å¾—ï¼ˆé‡è¤‡ã‚’é™¤ãï¼‰
                    const fontNames = new Set();
                    availableFonts.forEach(font => {
                        // familyãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨
                        if (font.family) {
                            fontNames.add(font.family);
                        }
                    });
                    
                    allFonts = Array.from(fontNames).sort();
                    
                    if (allFonts.length === 0) {
                        fontList.innerHTML = '<div class="loading">ãƒ•ã‚©ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</div>';
                    } else {
                        displayFonts(allFonts);
                    }
                } catch (error) {
                    if (error.name === 'NotAllowedError') {
                        fontList.innerHTML = '<div class="loading">ãƒ•ã‚©ãƒ³ãƒˆã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸã€‚<br>ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‹ã‚‰è¨±å¯ã—ã¦ãã ã•ã„ã€‚</div>';
                    } else {
                        fontList.innerHTML = '<div class="loading">ãƒ•ã‚©ãƒ³ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message + '</div>';
                    }
                }
            } else {
                // Local Font Access APIãŒä½¿ãˆãªã„å ´åˆã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
                fontList.innerHTML = '<div class="loading">ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯Local Font Access APIã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚<br>Chrome/Edge 103ä»¥é™ã‚’ãŠä½¿ã„ãã ã•ã„ã€‚<br><br>ã¾ãŸã¯ã€ã€Œãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ã‚¿ãƒ–ã‹ã‚‰ãƒ•ã‚©ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„ã€‚</div>';
            }
        }

        // ãƒ•ã‚©ãƒ³ãƒˆä¸€è¦§ã®è¡¨ç¤º
        function displayFonts(fonts) {
            const fontList = document.getElementById('fontList');
            const text = document.getElementById('textInput1').value || 'The quick brown fox jumps over the lazy dog';
            const fontSize = document.getElementById('fontSize1').value;
            const lineHeight = document.getElementById('lineHeight1').value;
            
            if (fonts.length === 0) {
                fontList.innerHTML = '<div class="loading">ãƒ•ã‚©ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</div>';
                return;
            }

            fontList.innerHTML = fonts.map(font => `
                <div class="font-item">
                    <div class="font-name">${font}</div>
                    <div class="font-preview" style="font-family: '${font}'; font-size: ${fontSize}px; line-height: ${lineHeight};">
                        ${text}
                    </div>
                </div>
            `).join('');
        }

        // ãƒ•ã‚©ãƒ³ãƒˆæ¤œç´¢
        function filterFonts() {
            const searchTerm = document.getElementById('fontSearch').value.toLowerCase();
            const filteredFonts = allFonts.filter(font => 
                font.toLowerCase().includes(searchTerm)
            );
            displayFonts(filteredFonts);
        }

        // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒ•ã‚©ãƒ³ãƒˆã®æ›´æ–°
        function updateInstalledFonts() {
            const fontSize1 = document.getElementById('fontSize1');
            const lineHeight1 = document.getElementById('lineHeight1');
            document.getElementById('fontSizeValue1').textContent = fontSize1.value + 'px';
            document.getElementById('lineHeightValue1').textContent = lineHeight1.value;
            
            if (allFonts.length > 0) {
                displayFonts(allFonts);
            }
        }

        // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ³ãƒˆã®å‡¦ç†
        const fontFileInput = document.getElementById('fontFile');
        const textInput2 = document.getElementById('textInput2');
        const fontSize2 = document.getElementById('fontSize2');
        const lineHeight2 = document.getElementById('lineHeight2');
        const previewText = document.getElementById('previewText');
        const fileName = document.getElementById('fileName');
        const uploadFontName = document.getElementById('uploadFontName');

        fontFileInput.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            fileName.textContent = file.name;
            uploadFontName.textContent = file.name;

            const reader = new FileReader();
            reader.onload = async (event) => {
                const fontData = event.target.result;
                const fontName = 'CustomFont_' + Date.now();
                
                try {
                    const fontFace = new FontFace(fontName, fontData);
                    await fontFace.load();
                    document.fonts.add(fontFace);
                    currentFont = fontName;
                    updateUploadPreview();
                } catch (error) {
                    alert('ãƒ•ã‚©ãƒ³ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                }
            };
            reader.readAsArrayBuffer(file);
        });

        textInput2.addEventListener('input', updateUploadPreview);
        fontSize2.addEventListener('input', (e) => {
            document.getElementById('fontSizeValue2').textContent = e.target.value + 'px';
            updateUploadPreview();
        });
        lineHeight2.addEventListener('input', (e) => {
            document.getElementById('lineHeightValue2').textContent = e.target.value;
            updateUploadPreview();
        });

        function updateUploadPreview() {
            const text = textInput2.value || 'ã“ã“ã«æ–‡å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
            previewText.textContent = text;

            if (currentFont) {
                previewText.style.fontFamily = currentFont;
            }

            previewText.style.fontSize = fontSize2.value + 'px';
            previewText.style.lineHeight = lineHeight2.value;
        }

        // åˆæœŸåŒ–
        loadInstalledFonts();
        updateUploadPreview();
    </script>
</body>
</html>
